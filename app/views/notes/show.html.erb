<h2>Notes for <%= @lobby.name %></h2>

<%= form_with url: lobby_note_path(@lobby), model: @note, local: true do |form| %>
  <div class="mb-3">
    <% if current_user == @lobby.owner || current_user.lobby_members.find_by(lobby: @lobby)&.can_edit_notes? %>
      <%= form.text_area :content, rows: 10, class: "form-control", placeholder: "Write notes here..." %>
      <div class="mt-3">
        <% button_text = @note.persisted? ? "Save Note" : "Create Note" %>
        <%= form.submit button_text, class: "btn btn-primary" %>
      </div>
    <% else %>
      <div class="bg-gray-100 p-3 rounded font-mono whitespace-pre-line">
        <%= @note&.content.presence || "No notes yet." %>
      </div>
    <% end %>
    <%= link_to "Back to Lobby", lobby_path(@lobby), class: "btn btn-secondary mt-3" %>
  </div>
<% end %>
